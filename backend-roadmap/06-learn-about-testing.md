# 6. Learn about Testing | テストについて学ぶ

## 概要

- テストとは
- テストの種類
- テストの設計技法
- テストレベル
- テストダブル
- テスティングフレームワーク

## テスト(ソフトウェアテスト)とは

> ソフトウェアテスト (Software testing) は、コンピュータのプログラムから仕様にない振舞または欠陥（バグ）を見つけ出す作業のことである。ソフトウェアテストで見つかったプログラム中の欠陥を修正する作業をデバッグという。ソフトウェアテストに成功するとは、テストで欠陥が発見されるか、規定した試験項目にすべて合格するか、規定した品質目標に到達することである。目標とした品質には、規定した試験項目にすべて合格することもある。例えば、OS, プログラミング言語では、仕様を満たしているかどうかの適合試験を規定している。ソフトウェアテストでは、欠陥が存在することを示すことはできるが、欠陥が存在しないことは証明できない。ソフトウェアに仕様にない振舞がないことを保証する作業を証明といい、証明用のシステム、証明しやすい言語も多数存在している。本項では動的なソフトウェアテストを中心に扱う。

Wikipedia より引用

### バグとは

システムが要件を満たさないこと

- 要件
  - 機能要件
    - コメントが投稿できること、など
  - 非機能要件
    - 画面描写は 30 秒以内に完了すること、など

## テストの種類

- 静的テスト
  - ツールを用いたコードの静的解析
  - コードレビュー
- <b>動的テスト</b>
  - 実際にコードを実行
  - <b>通常、テストと言ったらこちらを意味する</b>

### 動的テストの方法

- 手動テスト
  - テスト仕様書に基づいて、人手で値を入力し結果を検証する
  - プログラムの修正の度に実施するのはコストが高い
- 自動テスト
  - システムの要件を検証するプログラム(テストコード)を作成し、実行する
  - 作成に時間がかかるが、一度作ってしまえば再テストが容易で時間がかからない

## テスト設計技法

欠陥の抜け漏れがないようにテスト対象を網羅する方法

### ホワイトボックステスト/構造ベーステスト

- プログラムの命令や分岐(内部構造)に着目
- 作り手目線のテスト
- どれだけの割合の部分を実行できたかを`網羅率`で表す
  - 命令網羅
  - 分岐網羅
  - 条件網羅

### ブラックボックステスト/仕様ベーステスト

- プログラムの入力と出力に着目
- 利用者目線のテスト
- 主な技法
  - プログラムの入力が単一の値の場合
    - 同値分割
    - 限界値分析
  - プログラムの入力が複数の場合
    - ディシジョンテーブル
    - 原因結果グラフ

### 経験ベーステスト

- テスト担当者のスキルや経験則などを使ったテスト
- 主な技法
  - エラー推測
  - 探索的テスト

## テストレベル

テストレベル = プログラムのどの範囲をテストするか

- 単体テスト | Unit Testing
  - メソッド、クラスなどの小さな単位で行うテスト
  - 基本はブラックボックステスト
  - ブラックボックステストが済んだら品質を確保するためホワイトボックステスト
- 結合テスト | Integration Testing
  - 単体テストが完了した部品を組み合わせて行うテスト
- システムテスト | System Testing
  - プログラムをハードウェア、ネットワーク、データベースなどと組み合わせて行うテスト
  - 開発環境が本番環境と異なる場合、本番環境を使って行うケースもある
- 受入テスト | Acceptance Testing
  - 利用者や顧客がシステムを受け理れるかどうかを判定するテスト

## テストダブル

テスト対象が依存しているコンポーネントを置き換える技法

### スタブ

- 受信メッセージのテスト
- 以下のようなときに用いる
  - 依存オブジェクトが予想できない振る舞いを持つ
  - 依存オブジェクトのクラスがまだ存在しない
  - 依存オブジェクトの実行コストが高く、簡単に利用できない
  - 依存オブジェクトが実行環境に強く依存している

### モック

- 送信メッセージのテスト
- メソッドが正しく呼び出だされているかを検証するもの

## テスティングフレームワーク

### Ruby

- Minitest
  - デフォルト
  - 標準ライブラリ
- RSpec
  - デファクトスタンダード ?
  - gem (外部ライブラリ)
  - BDD のためのテスティングフレームワーク
